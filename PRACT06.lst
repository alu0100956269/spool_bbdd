SQL> ;
SP2-0223: No lines in SQL buffer.
SQL> REM 1
SQL> SELECT SYSDATE;
SELECT SYSDATE
             *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT SYSDATE
  2  FROM DUAL;

SYSDATE                                                                         
---------                                                                       
17-NOV-17                                                                       

SQL> SELECT SYSDATETIME
  2  FROM DUAL;
SELECT SYSDATETIME
       *
ERROR at line 1:
ORA-00904: "SYSDATETIME": invalid identifier 


SQL> SELECT CONVERT (TIME, SYSDATETIME());
SELECT CONVERT (TIME, SYSDATETIME())
                                   *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT CONVERT (TIME, SYSDATETIME())
  2  FROM DUAL;
SELECT CONVERT (TIME, SYSDATETIME())
                      *
ERROR at line 1:
ORA-00904: "SYSDATETIME": invalid identifier 


SQL> SELECT EXTRACT (HOUR FROM SYSDATE);
SELECT EXTRACT (HOUR FROM SYSDATE)
                                 *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT EXTRACT (HOUR FROM SYSDATE)
  2  FROM DUAL;
SELECT EXTRACT (HOUR FROM SYSDATE)
                          *
ERROR at line 1:
ORA-30076: invalid extract field for extract source 


SQL> select to_char(sysdate, 'HH24:MI:SS') from dual;

TO_CHAR(                                                                        
--------                                                                        
12:14:36                                                                        

SQL> REM 3
SQL> select to_char(sysdate, 'DAY', 'NLS_DATE_LANGUAGE=SPANISH')
  2  from dual ;

TO_CHAR(SYSDATE,'DAY','NLS_DATE_LANG                                            
------------------------------------                                            
VIERNES                                                                         

SQL> SELECT SYSTIMESTAMP FROM DUAL;

SYSTIMESTAMP                                                                    
---------------------------------------------------------------------------     
17-NOV-17 12.19.03.950267 PM +00:00                                             

SQL> SELECT SYSTIMESTAMP(8) FROM DUAL;

SYSTIMESTAMP(8)                                                                 
---------------------------------------------------------------------------     
17-NOV-17 12.19.40.62151400 PM +00:00                                           

SQL> SELECT CURRENT_TIMESTAMP FROM DUAL;

CURRENT_TIMESTAMP                                                               
---------------------------------------------------------------------------     
17-NOV-17 12.20.19.999399 PM +00:00                                             

SQL> REM AADIR A LA TABLA DEPARTAMENTO UNA NUEVA COLUMNA
SQL> ALTER TABLE DEPARTAMENTO
  2  ADD (D1 TIMESTAMP(8) DEFAULT SYSTIMESTAMP(8));

Table altered.

SQL> SELECT * FROM DEPARTAMENTO;

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         1 ANALISIS MATEMATICO                                                  
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                
         2 ASTROFISICA                                                          
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         4 MATEMATICA FUNDAMENTAL                                               
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                

SQL> ALTER TABLE DEPARTAMENTO
  2  MODIFY (D1 TIMESTAMP(9));

Table altered.

SQL> SELECT * FROM DEPARTAMENTO;

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         1 ANALISIS MATEMATICO                                                  
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                
         2 ASTROFISICA                                                          
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         4 MATEMATICA FUNDAMENTAL                                               
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                

SQL> ALTER TABLE DEPARTAMENTO
  2  RENAME COLUMN D1 TO D2;

Table altered.

SQL> DESCRIBE DEPARTAMENTO;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(60)
 D2                                                 TIMESTAMP(9)

SQL> ALTER TABLE DEPARTAMENTO
  2  DROP COLUMN D2;

Table altered.

SQL> DESCRIBE DEPARTAMENTO;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(60)

SQL> DROP TABLE DEPARTAMENTO;
DROP TABLE DEPARTAMENTO
           *
ERROR at line 1:
ORA-02449: unique/primary keys in table referenced by foreign keys 


SQL> REM 3
SQL> SELECT SYSDATE 'DAY' FROM DUAL;
SELECT SYSDATE 'DAY' FROM DUAL
               *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT TO_CHAR(SYSDATE, 'DAY:DD:MM:YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAY:DD:MM:YYYY')                                               
-----------------------------------------------                                 
FRIDAY   :17:11:2017                                                            

SQL> SELECT TO_CHAR(SYSDATE, 'DAY DD:MM:YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAYDD:MM:YYYY')                                                
-----------------------------------------------                                 
FRIDAY    17:11:2017                                                            

SQL> SELECT TO_CHAR(SYSDATE, 'DAY DD/MM/YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAYDD/MM/YYYY')                                                
-----------------------------------------------                                 
FRIDAY    17/11/2017                                                            

SQL> REM CONSULTA DE CLASE
SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE COUNT(DISTINCT T) >= 2
  4  GROUP BY DNI;
WHERE COUNT(DISTINCT T) >= 2
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE DISTINCT T IN (SELECT COUNT(DISTINCT T)
  4  
SQL> 
SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI, T
  4  HAVING COUNT(DISTINCT T) >= 2;

no rows selected

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI
  4  HAVING COUNT(DISTINCT T) >= 2;

       DNI                                                                      
----------                                                                      
      4444                                                                      

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI
  4  HAVING COUNT(DISTINCT T) >= 2
  5  WHERE FF=NULL;
WHERE FF=NULL
*
ERROR at line 5:
ORA-00933: SQL command not properly ended 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI
  4  HAVING COUNT(DISTINCT T) >= 2
  5  WHERE FF = 'NULL';
WHERE FF = 'NULL'
*
ERROR at line 5:
ORA-00933: SQL command not properly ended 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE FF = 'NULL';
WHERE FF = 'NULL'
           *
ERROR at line 3:
ORA-01858: a non-numeric character was found where a numeric was expected 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE FF=NULL
  4  GROUP BY DNI
  5  HAVING COUNT(DISTINCT T) >= 2;

no rows selected

SQL> REM CONSULTA DE CLASE (ACABADA CORRECTAMENTE)
SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE FF=NULL
  4  GROUP BY DNI
  5  HAVING COUNT(DISTINCT T) >= 2;

no rows selected

SQL> SELECT TO_CHAR(SYSDATE, 'HH24:MI:SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
12:54:43                                                                        

SQL> REM 5
SQL> SELECT SYSDATE
  2  FROM DUAL
  3  MINUS
  4  SELECT FI
  5  FROM PLAN_DOCENTE
  6  WHERE (DNI=8) AND (CAS=11);

SYSDATE                                                                         
---------                                                                       
17-NOV-17                                                                       

SQL> SELECT COUNT(SYSDATE - FI)
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8) AND (CAS=11);

COUNT(SYSDATE-FI)                                                               
-----------------                                                               
                0                                                               

SQL> SELECT COUNT(SYSDATE - FI)
  2  FROM PLAN_DOCENTE NATURAL JOIN DUAL
  3  WHERE (DNI=8) AND (CAS=11);

COUNT(SYSDATE-FI)                                                               
-----------------                                                               
                0                                                               

SQL> SELECT SYSDATE - FI
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8) AND (CAS=11);

no rows selected

SQL> SELECT (SYSDATE-FI)
  2  FROM PLAN_DOCENTE NATURAL JOIN DUAL
  3  WHERE (DNI=8) AND (CAS=11);

no rows selected

SQL> SPOOL OFF
SQL> ;
SP2-0223: No lines in SQL buffer.
SQL> REM 5
SQL> SELECT SYSDATE-FI
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8888) AND (CAS=11);

SYSDATE-FI                                                                      
----------                                                                      
 3005.9277                                                                      

SQL> SELECT TO_CHAR(SYSDATE-FI, 'DD:24HH:MI:SS')
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8888) AND (CAS=11);
SELECT TO_CHAR(SYSDATE-FI, 'DD:24HH:MI:SS')
                           *
ERROR at line 1:
ORA-01481: invalid number format model 


SQL> REM 6
SQL> SELECT DISTINCT P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF-FI) >= 365;

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
DAVID                                                                           
CARMEN                                                                          
MARIA                                                                           

SQL> SELECT DISTINCT P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF-FI) >= 365
  4  UNION
  5  SELECT DISTINCT P
  6  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  7  WHERE (FF IS NULL) AND ((SYSDATE-FI) >= 365);

P                                                                               
------------------------------------------------------------                    
ANGELA                                                                          
CARLOS                                                                          
CARMEN                                                                          
DAVID                                                                           
FRANCISCO                                                                       
IVAN                                                                            
JOSE MANUEL                                                                     
JUAN                                                                            
MARIA                                                                           
MARIO                                                                           
PEDRO                                                                           

P                                                                               
------------------------------------------------------------                    
SOLEDAD                                                                         

12 rows selected.

SQL> REM 7
SQL> SELECT COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  WHERE D='ASTROFISICA';

COUNT(DISTINCTP)                                                                
----------------                                                                
               1                                                                

SQL> REM 8
SQL> SELECT D,COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  GROUP BY CD
  4  ORDER BY D;
SELECT D,COUNT(DISTINCT P)
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT D, COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  GROUP BY CD
  4  ORDER BY D;
SELECT D, COUNT(DISTINCT P)
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  GROUP BY CD
  4  ORDER BY D;
ORDER BY D
         *
ERROR at line 4:
ORA-00979: not a GROUP BY expression 


SQL> REM EJERCICIO 8 NO RESUELTO, PREGUNTAR EN CLASE
SQL> REM 9
SQL> REM 9
SQL> SELECT COUNT(DISTINCT T)
  2  FROM ASIGNATURA NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  WHERE D='ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION'
  4  ;

COUNT(DISTINCTT)                                                                
----------------                                                                
               2                                                                

SQL> 
SQL> REM 10
SQL> SELECT COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%'
  4  GROUP BY CAR;

COUNT(DISTINCTP)                                                                
----------------                                                                
               1                                                                
               1                                                                
               1                                                                

SQL> SELECT SUM(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%'
  4  GROUP BY CAR;
SELECT SUM(DISTINCT P)
 *
ERROR at line 1:
ORA-01722: invalid number 


SQL> SELECT SUM(COUNT(DISTINCT P))
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%'
  4  GROUP BY CAR;

SUM(COUNT(DISTINCTP))                                                           
---------------------                                                           
                    3                                                           

SQL> REM 11
SQL> SELECT (DISTINCT T), COUNT(A)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;
SELECT (DISTINCT T), COUNT(A)
        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> SELECT DISTINCT T, COUNT(A)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;

T      COUNT(A)                                                                 
---- ----------                                                                 
GF            1                                                                 
GII           7                                                                 
GM            2                                                                 
MII           2                                                                 

SQL> 
SQL> REM 12
SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT= (SELECT MAX(DISTINCT CT) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ENSEANZA DE LA MATEMATICA                                                       

SQL> 
SQL> 
SQL> REM 13
SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT= (SELECT MIN(DISTINCT CT) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
INTELIGENCIA ARTIFICIAL                                                         
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                

SQL> 
SQL> 
SQL> REM 14
SQL> SELECT A, (CT+CP+CL) NC_TOTALES
  2  FROM ASIGNATURA;

A                                                  NC_TOTALES                   
-------------------------------------------------- ----------                   
BASE DE DATOS                                               6                   
INTELIGENCIA ARTIFICIAL                                     6                   
ALMACENES DE DATOS                                          3                   
MINERIA DE DATOS                                            3                   
INFORMATICA BASICA                                          6                   
ALGEBRA                                                     6                   
CALCULO                                                     6                   
OPTIMIZACION                                                6                   
GESTION DE RIESGOS                                          6                   
ASTRONOMIA                                                  6                   
ENSEANZA DE LA MATEMATICA                                   6                   

A                                                  NC_TOTALES                   
-------------------------------------------------- ----------                   
ANALISIS COMPLEJO                                         7.5                   

12 rows selected.

SQL> 
SQL> 
SQL> REM 15
SQL> SELECT A FROM ASIGNATURA
  2  WHERE CT=(SELECT MAX(DISTINCT CT+CP+CL) FROM ASIGNATURA);

no rows selected

SQL> SELECT A FROM ASIGNATURA
  2  WHERE CT=(SELECT MAX(CT+CP+CL) FROM ASIGNATURA);

no rows selected

SQL> SELECT A FROM ASIGNATURA
  2  WHERE (CT+CP+CL)=(SELECT MAX(CT+CP+CL) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ANALISIS COMPLEJO                                                               

SQL> 
SQL> 
SQL> REM 16
SQL> SELECT A FROM ASIGNATURA
  2  WHERE (CT+CP+CL)=(SELECT MIN(DISTINCT CT+CP+CL) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                

SQL> 
SQL> 
SQL> REM 17
SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  WHERE (CT+CP+CL)=(SELECT MAX(DISTINCT CT+CP+CL) FROM ASIGNATURA);

AR                                                                              
------------------------------------------------------------                    
ANALISIS MATEMATICO                                                             

SQL> 
SQL> 
SQL> 
SQL> REM 18
SQL> SELECT COUNT(DISTINCT CAS)
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

COUNT(DISTINCTCAS)                                                              
------------------                                                              
                 1                                                              

SQL> REM LA CONSULTA ANTERIOR EN EL CASO DE QUE SE QUIERAN DIFERENTES ASIGNATURAS
SQL> SELECT COUNT(CAS)
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

COUNT(CAS)                                                                      
----------                                                                      
         2                                                                      

SQL> REM LA CONSULTA ANTERIOR EN EL CASO DE QUE PUEDA SER LA MISMA ASIGNATURA
SQL> 
SQL> 
SQL> 
SQL> REM 19
SQL> SELECT (CTA+CPA+CLA) NC_TOTALES
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

NC_TOTALES                                                                      
----------                                                                      
         6                                                                      
         3                                                                      

SQL> SELECT SUM(CTA+CPA+CLA) NC_TOTALES
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

NC_TOTALES                                                                      
----------                                                                      
         9                                                                      

SQL> 
SQL> 
SQL> 
SQL> REM 20
SQL> SELECT P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF IS NOT NULL) AND SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CPA+CLA))
  4  FROM PLAN_DOCENTE
  5  GROUP BY DNI);
WHERE (FF IS NOT NULL) AND SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CPA+CLA))
                           *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> REM PRUEBAS
SQL> SELECT SUM(CTA+CPA+CLA), P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  GROUP BY DNI;
SELECT SUM(CTA+CPA+CLA), P
                         *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT SUM(CTA+CPA+CLA)
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  GROUP BY DNI;

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
              15                                                                
               9                                                                
               3                                                                
               6                                                                
               3                                                                
               9                                                                
              12                                                                
               6                                                                
               6                                                                
             7.5                                                                
               6                                                                

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
               6                                                                

12 rows selected.

SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  SELECT MAX(SUM(CTA+CPA+CLA))
  4  
SQL> 
SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  GROUP BY DNI;

MAX(SUM(CTA+CPA+CLA))                                                           
---------------------                                                           
                   15                                                           

SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF IS NOT NULL)
  4  GROUP BY DNI;

MAX(SUM(CTA+CPA+CLA))                                                           
---------------------                                                           
                   12                                                           

SQL> SELECT SUM(CTA+CPA+CLA)
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF IS NOT NULL)
  4  GROUP BY DNI;

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
              12                                                                
               6                                                                
               3                                                                
               3                                                                
               6                                                                

SQL> 
SQL> 
SQL> 
SQL> REM 21
SQL> SELECT AVG(COUNT(CAS))
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  GROUP BY CAR;

AVG(COUNT(CAS))                                                                 
---------------                                                                 
            1.5                                                                 

SQL> SELECT AVG(COUNT(CAS))
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(CAS))                                                                 
---------------                                                                 
            1.5                                                                 

SQL> SELECT AVG(CAS)
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

  AVG(CAS)                                                                      
----------                                                                      
         6                                                                      
         8                                                                      
        12                                                                      
       5.5                                                                      
        11                                                                      
         7                                                                      
      3.25                                                                      
        10                                                                      

8 rows selected.

SQL> SELECT AVG(COUNT(DISTINCT CAS))
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(DISTINCTCAS))                                                         
-----------------------                                                         
                    1.5                                                         

SQL> REM EJERCICIOS 20,21 Y 22 PREGUNTAR EN CLASE
SQL> 
SQL> 
SQL> 
SQL> REM 23
SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  GROUP BY CAR;
SELECT AR
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  WHERE COUNT(CAS) > 3
  4  GROUP BY CAR;
WHERE COUNT(CAS) > 3
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  WHERE 3 > (SELECT COUNT(CAS)
  4  FROM ASIGNATURA
  5  GROUP BY CAR);
WHERE 3 > (SELECT COUNT(CAS)
           *
ERROR at line 3:
ORA-01427: single-row subquery returns more than one row 


SQL> REM FALTAN LOS EJERCICIOS DEL 20 AL 25
SQL> SPOOL OFF
SQL> ;
SP2-0223: No lines in SQL buffer.
SQL> 
SQL> REM 20
SQL> 
SQL> SELECT P
  2  FROM PROFESOR NATURAL JOIN PLAN_DOCENTE
  3  WHERE FF IS NULL
  4  GROUP BY P
  5  HAVING SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CLA+CPA))
  6  FROM PLAN DOCENTE
  7  WHERE FF IS NULL
  8  GROUP BY DNI);
FROM PLAN DOCENTE
     *
ERROR at line 6:
ORA-00942: table or view does not exist 


SQL> 
SQL> 
SQL> 
SQL> 
SQL> SELECT P
  2  FROM PROFESOR NATURAL JOIN PLAN_DOCENTE
  3  WHERE FF IS NULL
  4  GROUP BY P
  5  HAVING SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CLA+CPA))
  6  FROM PLAN_DOCENTE
  7  GROUP BY DNI);

no rows selected

SQL> 
SQL> SELECT P
  2  FROM PROFESOR NATURAL JOIN PLAN_DOCENTE
  3  WHERE FF IS NULL
  4  GROUP BY P
  5  HAVING SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CLA+CPA))
  6  FROM PLAN_DOCENTE
  7  WHERE FF IS NULL
  8  GROUP BY DNI);

P                                                                               
------------------------------------------------------------                    
PEDRO                                                                           
MARIA                                                                           

SQL> 
SQL> 
SQL> 
SQL> REM 21
SQL> 
SQL> SELECT AVG(COUNT(DISTINCT A))
  2  FROM ASIGNATURA;
SELECT AVG(COUNT(DISTINCT A))
           *
ERROR at line 1:
ORA-00978: nested group function without GROUP BY 


SQL> SELECT AVG(COUNT(DISTINCT A))
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(DISTINCTA))                                                           
---------------------                                                           
                1.625                                                           

SQL> 
SQL> 
SQL> 
SQL> 
SQL> REM 22
SQL> 
SQL> SELECT AVG(COUNT(DISTINCT P))
  2  FROM PROFESOR
  3  
SQL> 
SQL> 
SQL> 
SQL> 
SQL> REM 22
SQL> 
SQL> SELECT AVG(COUNT(DISTINCT P))
  2  FROM PROFESOR NATURAL JOIN ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(DISTINCTP))                                                           
---------------------                                                           
                 1.75                                                           

SQL> 
SQL> 
SQL> SELECT AVG(COUNT(DISTINCT P))
  2  FROM PROFESOR NATURAL JOIN ASIGNATURA
  3  GROUP BY CD;
GROUP BY CD
         *
ERROR at line 3:
ORA-00904: "CD": invalid identifier 


SQL> 
SQL> 
SQL> SELECT AVG(COUNT(DISTINCT P))
  2  FROM PROFESOR NATURAL JOIN AREA
  3  GROUP BY CD;

AVG(COUNT(DISTINCTP))                                                           
---------------------                                                           
                  3.5                                                           

SQL> SET LINESIZE 200
SQL> SELECT * FROM PROFESOR;

       DNI P                                                                   CAR CAT                                                                                                                  
---------- ------------------------------------------------------------ ---------- -----                                                                                                                
      1111 JUAN                                                                  6 CU                                                                                                                   
      2222 CARLOS                                                                7 TU                                                                                                                   
      3333 PEDRO                                                                 4 TEU                                                                                                                  
      4444 MARIA                                                                 7 TU                                                                                                                   
      5555 IVAN                                                                  1 CEU                                                                                                                  
      6666 CARMEN                                                                3 CD                                                                                                                   
      7777 MARIO                                                                 2 TU                                                                                                                   
      8888 FRANCISCO                                                             5 TU                                                                                                                   
      9999 ANGELA                                                                8 TEU                                                                                                                  
      1010 DAVID                                                                 4 TU                                                                                                                   
      2020 SOLEDAD                                                               7 CU                                                                                                                   

       DNI P                                                                   CAR CAT                                                                                                                  
---------- ------------------------------------------------------------ ---------- -----                                                                                                                
      3030 JOSE MANUEL                                                           6 TEU                                                                                                                  
      4040 CARMELO                                                               7 TU                                                                                                                   
      5050 CARINA                                                                8 CEU                                                                                                                  

14 rows selected.

SQL> SELECT * FROM PROFESOR NATURAL JOIN AREA;

       CAR        DNI P                                                            CAT   AR                                                                   CD                                        
---------- ---------- ------------------------------------------------------------ ----- ------------------------------------------------------------ ----------                                        
         1       5555 IVAN                                                         CEU   ALGEBRA                                                               4                                        
         2       7777 MARIO                                                        TU    ANALISIS MATEMATICO                                                   1                                        
         3       6666 CARMEN                                                       CD    ASTRONOMIA Y ASTROFISICA                                              2                                        
         4       3333 PEDRO                                                        TEU   CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                  3                                        
         4       1010 DAVID                                                        TU    CIENCIAS DE LA COMPUTACION E INTELIGENCIA ARTIFICIAL                  3                                        
         5       8888 FRANCISCO                                                    TU    DIDACTICA DE LA MATEMATICA                                            1                                        
         6       3030 JOSE MANUEL                                                  TEU   ESTADISTICA E INVESTIGACION OPERATIVA                                 3                                        
         6       1111 JUAN                                                         CU    ESTADISTICA E INVESTIGACION OPERATIVA                                 3                                        
         7       2222 CARLOS                                                       TU    LENGUAJES Y SISTEMAS INFORMATICOS                                     3                                        
         7       4444 MARIA                                                        TU    LENGUAJES Y SISTEMAS INFORMATICOS                                     3                                        
         7       2020 SOLEDAD                                                      CU    LENGUAJES Y SISTEMAS INFORMATICOS                                     3                                        

       CAR        DNI P                                                            CAT   AR                                                                   CD                                        
---------- ---------- ------------------------------------------------------------ ----- ------------------------------------------------------------ ----------                                        
         7       4040 CARMELO                                                      TU    LENGUAJES Y SISTEMAS INFORMATICOS                                     3                                        
         8       5050 CARINA                                                       CEU   MATEMATICAS APLICADAS                                                 1                                        
         8       9999 ANGELA                                                       TEU   MATEMATICAS APLICADAS                                                 1                                        

14 rows selected.

SQL> 
SQL> 
SQL> 
SQL> 
SQL> 
SQL> 
SQL> REM 23
SQL> 
SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  
SQL> 
SQL> 
SQL> SELECT AR
  2  FROM AREA
  3  GROUP BY CAR
  4  
SQL> 
SQL> 
SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  WHERE CAR=(SELECT CAR
  4  FROM AREA NATURAL JOIN ASIGNATURA
  5  GROUP BY CAR
  6  HAVING SUM(DISTINCT A)>3);
SELECT AR
 *
ERROR at line 1:
ORA-01722: invalid number 


SQL> SELECT AR
  2  FROM AREA
  3  WHERE CAR=(SELECT CAR
  4  FROM AREA NATURAL JOIN ASIGNATURA
  5  GROUP BY CAR
  6  HAVING SUM(DISTINCT A)>3);
SELECT AR
 *
ERROR at line 1:
ORA-01722: invalid number 


SQL> SELECT CAR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  GROUP BY CAR
  4  HAVING SUM(DISTINCT A)>3;
SELECT CAR
 *
ERROR at line 1:
ORA-01722: invalid number 


SQL> 
SQL> SELECT CAR FROM AREA;

       CAR                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              
         2                                                                                                                                                                                              
         3                                                                                                                                                                                              
         4                                                                                                                                                                                              
         5                                                                                                                                                                                              
         6                                                                                                                                                                                              
         7                                                                                                                                                                                              
         8                                                                                                                                                                                              

8 rows selected.

SQL> SELECT CAR FROM AREA NATURAL JOIN ASIGNATURA;

       CAR                                                                                                                                                                                              
----------                                                                                                                                                                                              
         7                                                                                                                                                                                              
         4                                                                                                                                                                                              
         7                                                                                                                                                                                              
         7                                                                                                                                                                                              
         7                                                                                                                                                                                              
         1                                                                                                                                                                                              
         8                                                                                                                                                                                              
         6                                                                                                                                                                                              
         4                                                                                                                                                                                              
         3                                                                                                                                                                                              
         5                                                                                                                                                                                              

       CAR                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              
         6                                                                                                                                                                                              

13 rows selected.

SQL> SELECT CAR
  2  FROM AREA NATURAL JOIN PLAN_DOCENTE
  3  GROUP BY CAR
  4  HAVING MAX(COUNT(DISTINCT AR));
HAVING MAX(COUNT(DISTINCT AR))
           *
ERROR at line 4:
ORA-00935: group function is nested too deeply 


SQL> SELECT CAR
  2  FROM AREA NATURAL JOIN PLAN_DOCENTE
  3  GROUP BY CAR
  4  HAVING COUNT(DISTINCT AR)>3;

no rows selected

SQL> SELECT CAR
  2  FROM AREA NATURAL JOIN PLAN_DOCENTE
  3  GROUP BY CAR
  4  HAVING COUNT(DISTINCT AR)<3;

       CAR                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              
         6                                                                                                                                                                                              
         2                                                                                                                                                                                              
         5                                                                                                                                                                                              
         4                                                                                                                                                                                              
         8                                                                                                                                                                                              
         3                                                                                                                                                                                              
         7                                                                                                                                                                                              

8 rows selected.

SQL> 
SQL> SELECT * FROM ASIGNATURA;

       CAS A                                                  T           CUR        CAR         CT         CP         CL                                                                               
---------- -------------------------------------------------- ---- ---------- ---------- ---------- ---------- ----------                                                                               
         1 BASE DE DATOS                                      GII           3          7          3        1.5        1.5                                                                               
         2 INTELIGENCIA ARTIFICIAL                            GII           3          4        1.5        1.5          3                                                                               
         3 ALMACENES DE DATOS                                 MII           1          7        1.5          0        1.5                                                                               
         4 MINERIA DE DATOS                                   MII           1          7        1.5          0        1.5                                                                               
         5 INFORMATICA BASICA                                 GII           1          7          3        1.5        1.5                                                                               
         6 ALGEBRA                                            GII           1          1          3          3          0                                                                               
         7 CALCULO                                            GII           1          8          3          3          0                                                                               
         8 OPTIMIZACION                                       GII           1          6          3        1.5        1.5                                                                               
         9 GESTION DE RIESGOS                                 GII           3          4          3          0          3                                                                               
        10 ASTRONOMIA                                         GF            2          3          3        1.5        1.5                                                                               
        11 ENSEANZA DE LA MATEMATICA                          GM            2          5          6          0          0                                                                               

       CAS A                                                  T           CUR        CAR         CT         CP         CL                                                                               
---------- -------------------------------------------------- ---- ---------- ---------- ---------- ---------- ----------                                                                               
        12 ANALISIS COMPLEJO                                  GM            4          2        4.5          3          0                                                                               
        13 ESTADISTICA                                        GII           3          6          0          0          0                                                                               

13 rows selected.

SQL> SELECT CAR FROM ASIGNATURA WHERE CAS=1;

       CAR                                                                                                                                                                                              
----------                                                                                                                                                                                              
         7                                                                                                                                                                                              

SQL> 
SQL> 
SQL> REM 23
SQL> 
SQL> SELECT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  WHERE CAR=(SELECT CAR
  4  FROM AREA NATURAL JOIN ASIGNATURA
  5  GROUP BY CAR
  6  HAVING COUNT(DISTINCT A) > 3);

AR                                                                                                                                                                                                      
------------------------------------------------------------                                                                                                                                            
LENGUAJES Y SISTEMAS INFORMATICOS                                                                                                                                                                       
LENGUAJES Y SISTEMAS INFORMATICOS                                                                                                                                                                       
LENGUAJES Y SISTEMAS INFORMATICOS                                                                                                                                                                       
LENGUAJES Y SISTEMAS INFORMATICOS                                                                                                                                                                       

SQL> 
SQL> 
SQL> REM 23
SQL> SELECT DISTINCT AR
  2  FROM AREA NATURAL JOIN ASIGNATURA
  3  GROUP BY CAR
  4  
SQL> 
SQL> REM 23
SQL> SELECT DISTINCT AR
  2  FROM AREA
  3  WHERE CAR=(SELECT CAR
  4  FROM AREA NATURAL JOIN ASIGNATURA
  5  GROUP BY CAR
  6  HAVING COUNT(DISTINCT A) > 3);

AR                                                                                                                                                                                                      
------------------------------------------------------------                                                                                                                                            
LENGUAJES Y SISTEMAS INFORMATICOS                                                                                                                                                                       

SQL> 
SQL> 
SQL> REM 24
SQL> SELECT DISTINCT AR
  2  FROM AREA
  3  WHERE CAR=(SELECT CAR
  4  FROM AREA NATURAL JOIN ASIGNATURA
  5  GROUP BY CAR
  6  HAVING COUNT(DISTINCT A) > 6);

no rows selected

SQL> 
SQL> 
SQL> 
SQL> SELECT D
  2  FROM DEPARTAMENTO
  3  WHERE CD=(SELECT CD
  4  FROM AREA NATURAL JOIN PROFESOR
  5  GROUP BY CD
  6  HAVING MAX(COUNT(DISTINCT P)));
HAVING MAX(COUNT(DISTINCT P)))
           *
ERROR at line 6:
ORA-00935: group function is nested too deeply 


SQL> 
SQL> SELECT D
  2  FROM DEPARTAMENTO
  3  WHERE CD=(SELECT CD
  4  FROM AREA NATURAL JOIN PROFESOR
  5  GROUP BY CD
  6  HAVING COUNT(DISTINCT P)=(SELECT MAX(COUNT(DISTINCT P))
  7  FROM AREA NATURAL JOIN PROFESOR
  8  GROUP BY CD));

D                                                                                                                                                                                                       
------------------------------------------------------------                                                                                                                                            
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                                                                                                                                                      

SQL> 
SQL> 
SQL> REM 25
SQL> SELECT D
  2  FROM DEPARTAMENTO
  3  WHERE CD IN (SELECT CD
  4  FROM AREA NATURAL JOIN PROFESOR
  5  GROUP BY CD
  6  HAVING COUNT(DISTINCT P)=(SELECT MAX(COUNT(DISTINCT P))
  7  FROM AREA NATURAL JOIN PROFESOR
  8  GROUP BY CD));

D                                                                                                                                                                                                       
------------------------------------------------------------                                                                                                                                            
ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                                                                                                                                                      

SQL> 
SQL> 
SQL> 
SQL> REM 25
SQL> SELECT D
  2  FROM DEPARTAMENTO
  3  WHERE CD IN (SELECT CD
  4  FROM AREA NATURAL JOIN PROFESOR
  5  GROUP BY CD
  6  HAVING COUNT(DISTINCT P)=(SELECT MIN(COUNT(DISTINCT P))
  7  FROM AREA NATURAL JOIN PROFESOR
  8  GROUP BY CD));

D                                                                                                                                                                                                       
------------------------------------------------------------                                                                                                                                            
ASTROFISICA                                                                                                                                                                                             
MATEMATICA FUNDAMENTAL                                                                                                                                                                                  

SQL> 
SQL> SPOOL OFF
