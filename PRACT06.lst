SQL> ;
SP2-0223: No lines in SQL buffer.
SQL> REM 1
SQL> SELECT SYSDATE;
SELECT SYSDATE
             *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT SYSDATE
  2  FROM DUAL;

SYSDATE                                                                         
---------                                                                       
17-NOV-17                                                                       

SQL> SELECT SYSDATETIME
  2  FROM DUAL;
SELECT SYSDATETIME
       *
ERROR at line 1:
ORA-00904: "SYSDATETIME": invalid identifier 


SQL> SELECT CONVERT (TIME, SYSDATETIME());
SELECT CONVERT (TIME, SYSDATETIME())
                                   *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT CONVERT (TIME, SYSDATETIME())
  2  FROM DUAL;
SELECT CONVERT (TIME, SYSDATETIME())
                      *
ERROR at line 1:
ORA-00904: "SYSDATETIME": invalid identifier 


SQL> SELECT EXTRACT (HOUR FROM SYSDATE);
SELECT EXTRACT (HOUR FROM SYSDATE)
                                 *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT EXTRACT (HOUR FROM SYSDATE)
  2  FROM DUAL;
SELECT EXTRACT (HOUR FROM SYSDATE)
                          *
ERROR at line 1:
ORA-30076: invalid extract field for extract source 


SQL> select to_char(sysdate, 'HH24:MI:SS') from dual;

TO_CHAR(                                                                        
--------                                                                        
12:14:36                                                                        

SQL> REM 3
SQL> select to_char(sysdate, 'DAY', 'NLS_DATE_LANGUAGE=SPANISH')
  2  from dual ;

TO_CHAR(SYSDATE,'DAY','NLS_DATE_LANG                                            
------------------------------------                                            
VIERNES                                                                         

SQL> SELECT SYSTIMESTAMP FROM DUAL;

SYSTIMESTAMP                                                                    
---------------------------------------------------------------------------     
17-NOV-17 12.19.03.950267 PM +00:00                                             

SQL> SELECT SYSTIMESTAMP(8) FROM DUAL;

SYSTIMESTAMP(8)                                                                 
---------------------------------------------------------------------------     
17-NOV-17 12.19.40.62151400 PM +00:00                                           

SQL> SELECT CURRENT_TIMESTAMP FROM DUAL;

CURRENT_TIMESTAMP                                                               
---------------------------------------------------------------------------     
17-NOV-17 12.20.19.999399 PM +00:00                                             

SQL> REM AADIR A LA TABLA DEPARTAMENTO UNA NUEVA COLUMNA
SQL> ALTER TABLE DEPARTAMENTO
  2  ADD (D1 TIMESTAMP(8) DEFAULT SYSTIMESTAMP(8));

Table altered.

SQL> SELECT * FROM DEPARTAMENTO;

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         1 ANALISIS MATEMATICO                                                  
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                
         2 ASTROFISICA                                                          
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         4 MATEMATICA FUNDAMENTAL                                               
17-NOV-17 12.22.44.59697800 PM                                                  
                                                                                

SQL> ALTER TABLE DEPARTAMENTO
  2  MODIFY (D1 TIMESTAMP(9));

Table altered.

SQL> SELECT * FROM DEPARTAMENTO;

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         1 ANALISIS MATEMATICO                                                  
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                
         2 ASTROFISICA                                                          
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                
         3 ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION                   
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                

        CD D                                                                    
---------- ------------------------------------------------------------         
D1                                                                              
---------------------------------------------------------------------------     
         4 MATEMATICA FUNDAMENTAL                                               
17-NOV-17 12.22.44.596978000 PM                                                 
                                                                                

SQL> ALTER TABLE DEPARTAMENTO
  2  RENAME COLUMN D1 TO D2;

Table altered.

SQL> DESCRIBE DEPARTAMENTO;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(60)
 D2                                                 TIMESTAMP(9)

SQL> ALTER TABLE DEPARTAMENTO
  2  DROP COLUMN D2;

Table altered.

SQL> DESCRIBE DEPARTAMENTO;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CD                                        NOT NULL NUMBER(2)
 D                                                  VARCHAR2(60)

SQL> DROP TABLE DEPARTAMENTO;
DROP TABLE DEPARTAMENTO
           *
ERROR at line 1:
ORA-02449: unique/primary keys in table referenced by foreign keys 


SQL> REM 3
SQL> SELECT SYSDATE 'DAY' FROM DUAL;
SELECT SYSDATE 'DAY' FROM DUAL
               *
ERROR at line 1:
ORA-00923: FROM keyword not found where expected 


SQL> SELECT TO_CHAR(SYSDATE, 'DAY:DD:MM:YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAY:DD:MM:YYYY')                                               
-----------------------------------------------                                 
FRIDAY   :17:11:2017                                                            

SQL> SELECT TO_CHAR(SYSDATE, 'DAY DD:MM:YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAYDD:MM:YYYY')                                                
-----------------------------------------------                                 
FRIDAY    17:11:2017                                                            

SQL> SELECT TO_CHAR(SYSDATE, 'DAY DD/MM/YYYY')
  2  FROM DUAL;

TO_CHAR(SYSDATE,'DAYDD/MM/YYYY')                                                
-----------------------------------------------                                 
FRIDAY    17/11/2017                                                            

SQL> REM CONSULTA DE CLASE
SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE COUNT(DISTINCT T) >= 2
  4  GROUP BY DNI;
WHERE COUNT(DISTINCT T) >= 2
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE DISTINCT T IN (SELECT COUNT(DISTINCT T)
  4  
SQL> 
SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI, T
  4  HAVING COUNT(DISTINCT T) >= 2;

no rows selected

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI
  4  HAVING COUNT(DISTINCT T) >= 2;

       DNI                                                                      
----------                                                                      
      4444                                                                      

SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI
  4  HAVING COUNT(DISTINCT T) >= 2
  5  WHERE FF=NULL;
WHERE FF=NULL
*
ERROR at line 5:
ORA-00933: SQL command not properly ended 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  GROUP BY DNI
  4  HAVING COUNT(DISTINCT T) >= 2
  5  WHERE FF = 'NULL';
WHERE FF = 'NULL'
*
ERROR at line 5:
ORA-00933: SQL command not properly ended 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE FF = 'NULL';
WHERE FF = 'NULL'
           *
ERROR at line 3:
ORA-01858: a non-numeric character was found where a numeric was expected 


SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE FF=NULL
  4  GROUP BY DNI
  5  HAVING COUNT(DISTINCT T) >= 2;

no rows selected

SQL> REM CONSULTA DE CLASE (ACABADA CORRECTAMENTE)
SQL> SELECT DNI
  2  FROM PLAN_DOCENTE NATURAL JOIN ASIGNATURA
  3  WHERE FF=NULL
  4  GROUP BY DNI
  5  HAVING COUNT(DISTINCT T) >= 2;

no rows selected

SQL> SELECT TO_CHAR(SYSDATE, 'HH24:MI:SS')
  2  FROM DUAL;

TO_CHAR(                                                                        
--------                                                                        
12:54:43                                                                        

SQL> REM 5
SQL> SELECT SYSDATE
  2  FROM DUAL
  3  MINUS
  4  SELECT FI
  5  FROM PLAN_DOCENTE
  6  WHERE (DNI=8) AND (CAS=11);

SYSDATE                                                                         
---------                                                                       
17-NOV-17                                                                       

SQL> SELECT COUNT(SYSDATE - FI)
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8) AND (CAS=11);

COUNT(SYSDATE-FI)                                                               
-----------------                                                               
                0                                                               

SQL> SELECT COUNT(SYSDATE - FI)
  2  FROM PLAN_DOCENTE NATURAL JOIN DUAL
  3  WHERE (DNI=8) AND (CAS=11);

COUNT(SYSDATE-FI)                                                               
-----------------                                                               
                0                                                               

SQL> SELECT SYSDATE - FI
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8) AND (CAS=11);

no rows selected

SQL> SELECT (SYSDATE-FI)
  2  FROM PLAN_DOCENTE NATURAL JOIN DUAL
  3  WHERE (DNI=8) AND (CAS=11);

no rows selected

SQL> SPOOL OFF
SQL> ;
SP2-0223: No lines in SQL buffer.
SQL> REM 5
SQL> SELECT SYSDATE-FI
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8888) AND (CAS=11);

SYSDATE-FI                                                                      
----------                                                                      
 3005.9277                                                                      

SQL> SELECT TO_CHAR(SYSDATE-FI, 'DD:24HH:MI:SS')
  2  FROM PLAN_DOCENTE
  3  WHERE (DNI=8888) AND (CAS=11);
SELECT TO_CHAR(SYSDATE-FI, 'DD:24HH:MI:SS')
                           *
ERROR at line 1:
ORA-01481: invalid number format model 


SQL> REM 6
SQL> SELECT DISTINCT P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF-FI) >= 365;

P                                                                               
------------------------------------------------------------                    
JUAN                                                                            
DAVID                                                                           
CARMEN                                                                          
MARIA                                                                           

SQL> SELECT DISTINCT P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF-FI) >= 365
  4  UNION
  5  SELECT DISTINCT P
  6  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  7  WHERE (FF IS NULL) AND ((SYSDATE-FI) >= 365);

P                                                                               
------------------------------------------------------------                    
ANGELA                                                                          
CARLOS                                                                          
CARMEN                                                                          
DAVID                                                                           
FRANCISCO                                                                       
IVAN                                                                            
JOSE MANUEL                                                                     
JUAN                                                                            
MARIA                                                                           
MARIO                                                                           
PEDRO                                                                           

P                                                                               
------------------------------------------------------------                    
SOLEDAD                                                                         

12 rows selected.

SQL> REM 7
SQL> SELECT COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  WHERE D='ASTROFISICA';

COUNT(DISTINCTP)                                                                
----------------                                                                
               1                                                                

SQL> REM 8
SQL> SELECT D,COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  GROUP BY CD
  4  ORDER BY D;
SELECT D,COUNT(DISTINCT P)
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT D, COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  GROUP BY CD
  4  ORDER BY D;
SELECT D, COUNT(DISTINCT P)
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  GROUP BY CD
  4  ORDER BY D;
ORDER BY D
         *
ERROR at line 4:
ORA-00979: not a GROUP BY expression 


SQL> REM EJERCICIO 8 NO RESUELTO, PREGUNTAR EN CLASE
SQL> REM 9
SQL> REM 9
SQL> SELECT COUNT(DISTINCT T)
  2  FROM ASIGNATURA NATURAL JOIN AREA NATURAL JOIN DEPARTAMENTO
  3  WHERE D='ESTADISTICA, INVESTIGACION OPERATIVA Y COMPUTACION'
  4  ;

COUNT(DISTINCTT)                                                                
----------------                                                                
               2                                                                

SQL> 
SQL> REM 10
SQL> SELECT COUNT(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%'
  4  GROUP BY CAR;

COUNT(DISTINCTP)                                                                
----------------                                                                
               1                                                                
               1                                                                
               1                                                                

SQL> SELECT SUM(DISTINCT P)
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%'
  4  GROUP BY CAR;
SELECT SUM(DISTINCT P)
 *
ERROR at line 1:
ORA-01722: invalid number 


SQL> SELECT SUM(COUNT(DISTINCT P))
  2  FROM PROFESOR NATURAL JOIN AREA
  3  WHERE AR LIKE 'A%'
  4  GROUP BY CAR;

SUM(COUNT(DISTINCTP))                                                           
---------------------                                                           
                    3                                                           

SQL> REM 11
SQL> SELECT (DISTINCT T), COUNT(A)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;
SELECT (DISTINCT T), COUNT(A)
        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> SELECT DISTINCT T, COUNT(A)
  2  FROM ASIGNATURA
  3  GROUP BY T
  4  ORDER BY T;

T      COUNT(A)                                                                 
---- ----------                                                                 
GF            1                                                                 
GII           7                                                                 
GM            2                                                                 
MII           2                                                                 

SQL> 
SQL> REM 12
SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT= (SELECT MAX(DISTINCT CT) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ENSEANZA DE LA MATEMATICA                                                       

SQL> 
SQL> 
SQL> REM 13
SQL> SELECT A
  2  FROM ASIGNATURA
  3  WHERE CT= (SELECT MIN(DISTINCT CT) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
INTELIGENCIA ARTIFICIAL                                                         
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                

SQL> 
SQL> 
SQL> REM 14
SQL> SELECT A, (CT+CP+CL) NC_TOTALES
  2  FROM ASIGNATURA;

A                                                  NC_TOTALES                   
-------------------------------------------------- ----------                   
BASE DE DATOS                                               6                   
INTELIGENCIA ARTIFICIAL                                     6                   
ALMACENES DE DATOS                                          3                   
MINERIA DE DATOS                                            3                   
INFORMATICA BASICA                                          6                   
ALGEBRA                                                     6                   
CALCULO                                                     6                   
OPTIMIZACION                                                6                   
GESTION DE RIESGOS                                          6                   
ASTRONOMIA                                                  6                   
ENSEANZA DE LA MATEMATICA                                   6                   

A                                                  NC_TOTALES                   
-------------------------------------------------- ----------                   
ANALISIS COMPLEJO                                         7.5                   

12 rows selected.

SQL> 
SQL> 
SQL> REM 15
SQL> SELECT A FROM ASIGNATURA
  2  WHERE CT=(SELECT MAX(DISTINCT CT+CP+CL) FROM ASIGNATURA);

no rows selected

SQL> SELECT A FROM ASIGNATURA
  2  WHERE CT=(SELECT MAX(CT+CP+CL) FROM ASIGNATURA);

no rows selected

SQL> SELECT A FROM ASIGNATURA
  2  WHERE (CT+CP+CL)=(SELECT MAX(CT+CP+CL) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ANALISIS COMPLEJO                                                               

SQL> 
SQL> 
SQL> REM 16
SQL> SELECT A FROM ASIGNATURA
  2  WHERE (CT+CP+CL)=(SELECT MIN(DISTINCT CT+CP+CL) FROM ASIGNATURA);

A                                                                               
--------------------------------------------------                              
ALMACENES DE DATOS                                                              
MINERIA DE DATOS                                                                

SQL> 
SQL> 
SQL> REM 17
SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  WHERE (CT+CP+CL)=(SELECT MAX(DISTINCT CT+CP+CL) FROM ASIGNATURA);

AR                                                                              
------------------------------------------------------------                    
ANALISIS MATEMATICO                                                             

SQL> 
SQL> 
SQL> 
SQL> REM 18
SQL> SELECT COUNT(DISTINCT CAS)
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

COUNT(DISTINCTCAS)                                                              
------------------                                                              
                 1                                                              

SQL> REM LA CONSULTA ANTERIOR EN EL CASO DE QUE SE QUIERAN DIFERENTES ASIGNATURAS
SQL> SELECT COUNT(CAS)
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

COUNT(CAS)                                                                      
----------                                                                      
         2                                                                      

SQL> REM LA CONSULTA ANTERIOR EN EL CASO DE QUE PUEDA SER LA MISMA ASIGNATURA
SQL> 
SQL> 
SQL> 
SQL> REM 19
SQL> SELECT (CTA+CPA+CLA) NC_TOTALES
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

NC_TOTALES                                                                      
----------                                                                      
         6                                                                      
         3                                                                      

SQL> SELECT SUM(CTA+CPA+CLA) NC_TOTALES
  2  FROM PLAN_DOCENTE
  3  WHERE DNI=1111;

NC_TOTALES                                                                      
----------                                                                      
         9                                                                      

SQL> 
SQL> 
SQL> 
SQL> REM 20
SQL> SELECT P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF IS NOT NULL) AND SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CPA+CLA))
  4  FROM PLAN_DOCENTE
  5  GROUP BY DNI);
WHERE (FF IS NOT NULL) AND SUM(CTA+CPA+CLA)=(SELECT MAX(SUM(CTA+CPA+CLA))
                           *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> REM PRUEBAS
SQL> SELECT SUM(CTA+CPA+CLA), P
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  GROUP BY DNI;
SELECT SUM(CTA+CPA+CLA), P
                         *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT SUM(CTA+CPA+CLA)
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  GROUP BY DNI;

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
              15                                                                
               9                                                                
               3                                                                
               6                                                                
               3                                                                
               9                                                                
              12                                                                
               6                                                                
               6                                                                
             7.5                                                                
               6                                                                

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
               6                                                                

12 rows selected.

SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  SELECT MAX(SUM(CTA+CPA+CLA))
  4  
SQL> 
SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  GROUP BY DNI;

MAX(SUM(CTA+CPA+CLA))                                                           
---------------------                                                           
                   15                                                           

SQL> SELECT MAX(SUM(CTA+CPA+CLA))
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF IS NOT NULL)
  4  GROUP BY DNI;

MAX(SUM(CTA+CPA+CLA))                                                           
---------------------                                                           
                   12                                                           

SQL> SELECT SUM(CTA+CPA+CLA)
  2  FROM PLAN_DOCENTE NATURAL JOIN PROFESOR
  3  WHERE (FF IS NOT NULL)
  4  GROUP BY DNI;

SUM(CTA+CPA+CLA)                                                                
----------------                                                                
              12                                                                
               6                                                                
               3                                                                
               3                                                                
               6                                                                

SQL> 
SQL> 
SQL> 
SQL> REM 21
SQL> SELECT AVG(COUNT(CAS))
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  GROUP BY CAR;

AVG(COUNT(CAS))                                                                 
---------------                                                                 
            1.5                                                                 

SQL> SELECT AVG(COUNT(CAS))
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(CAS))                                                                 
---------------                                                                 
            1.5                                                                 

SQL> SELECT AVG(CAS)
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

  AVG(CAS)                                                                      
----------                                                                      
         6                                                                      
         8                                                                      
        12                                                                      
       5.5                                                                      
        11                                                                      
         7                                                                      
      3.25                                                                      
        10                                                                      

8 rows selected.

SQL> SELECT AVG(COUNT(DISTINCT CAS))
  2  FROM ASIGNATURA
  3  GROUP BY CAR;

AVG(COUNT(DISTINCTCAS))                                                         
-----------------------                                                         
                    1.5                                                         

SQL> REM EJERCICIOS 20,21 Y 22 PREGUNTAR EN CLASE
SQL> 
SQL> 
SQL> 
SQL> REM 23
SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  GROUP BY CAR;
SELECT AR
       *
ERROR at line 1:
ORA-00979: not a GROUP BY expression 


SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  WHERE COUNT(CAS) > 3
  4  GROUP BY CAR;
WHERE COUNT(CAS) > 3
      *
ERROR at line 3:
ORA-00934: group function is not allowed here 


SQL> SELECT AR
  2  FROM ASIGNATURA NATURAL JOIN AREA
  3  WHERE 3 > (SELECT COUNT(CAS)
  4  FROM ASIGNATURA
  5  GROUP BY CAR);
WHERE 3 > (SELECT COUNT(CAS)
           *
ERROR at line 3:
ORA-01427: single-row subquery returns more than one row 


SQL> REM FALTAN LOS EJERCICIOS DEL 20 AL 25
SQL> SPOOL OFF
